{% extends "base.html" %}
{% from "_form.html" import ability_fields, language_field %}

{% block head %}
{{ super() }}
<link rel="stylesheet" href="{{ url_for('static', filename='css/toc.css') }}" />
{% endblock %}

{% block content %}
<h2>Trail of Cthlulu</h2>
<form>
  <ol>
    <li>
      <label for="player">Player</label>
      <input type="text" id="player" />
    </li>
    <li>
      <label for="name">Name</label>
      <input type="text" id="name" />
    </li>
    <li>
      <label for="age">Age</label>
      <input type="number" id="age" />
    </li>
    <li>
      <label for="name">Nationality</label>
      <input type="text" id="nationality" />
    </li>
    <li>
      <label for="occupation">Occupation</label>
      <select id="occupation" data-occupations="{{ occupations|tojson }}">
        {% for occupation in occupations %}
        <option value="{{ occupation }}">{{ occupation|title }}</option>
        {% endfor %}
      </select>
    </li>
    <li>
      <label for="name">Drive</label>
      <input type="text" id="drive" />
    </li>
  </ol>

  <fieldset>
    <legend>Abilities</legend>

    <fieldset>
      <legend>Investigative</legend>
      {% for category in investigative_abilities|sort %}
        {{ ability_fields(category.title(), investigative_abilities[category]) }}
      {% endfor %}
    </fieldset>

    {{ ability_fields("General", general_abilities) }}

  </fieldset>
</form>

<script>
  function setCredit(min, max) {
    var creditField = document.getElementById("ability-creditrating");
    creditField.min = min;
    creditField.max = max;
  };

  function setOccupation() {
    var occupationField = document.getElementById("occupation");
    var occupation = JSON.parse(
      occupationField.dataset.occupations)[occupationField.value];
    var container = document.getElementById("
  };

  function populateLanguages() {
      var languageField = document.getElementById("ability-languages");
      var languages = JSON.parse(languageField.dataset.languages);
      var container = document.getElementById("ability-languages-list");
      container.innerHTML = "";
      for (var i=0; i < languageField.value; i++) {
	  var li = document.createElement("li");
          var input = document.createElement("input");
          input.type = "text";
          input.name = "ability-language-" + i;
          input.setAttribute('aria-label', "Language " + i);
          input.value = i < languages.length ? languages[i] : "";
	  li.appendChild(input);
          container.appendChild(li);
      }
  };
</script>

{% endblock %}
